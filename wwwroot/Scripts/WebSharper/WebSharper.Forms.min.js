(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;b=a.WebSharper;c=b&&b.Obj;d=b.Forms=b.Forms||{};e=d.ErrorMessage=d.ErrorMessage||{};f=d.Fresh=d.Fresh||{};g=d.Result=d.Result||{};h=d.Form=d.Form||{};i=d.Utils=d.Utils||{};j=h.Dependent=h.Dependent||{};k=h.Many=h.Many||{};l=k.ItemOperations=k.ItemOperations||{};m=k.Fresh=k.Fresh||{};n=k.Collection=k.Collection||{};o=k.CollectionWithDefault=k.CollectionWithDefault||{};p=h.Builder=h.Builder||{};q=d.Validation=d.Validation||{};r=d.Pervasives=d.Pervasives||{};s=d.Attr=d.Attr||{};t=d.Doc=d.Doc||{};u=d.View=d.View||{};v=a.StartupCode$WebSharper_Forms$Forms=a.StartupCode$WebSharper_Forms$Forms||{};w=b&&b.Runtime;x=b&&b.List;y=b&&b.Collections;z=y&&y.Dictionary;A=b&&b.UI;B=A&&A.Doc;C=A&&A.View;D=A&&A.Var$1;E=b&&b.Seq;F=A&&A.Submitter;G=b&&b.Arrays;H=A&&A.Array;I=b&&b.Concurrency;J=b&&b.Unchecked;K=A&&A.AttrProxy;L=A&&A.AttrModule;e=d.ErrorMessage=w.Class({},c,e);e.Create=function(M,N){return new e.New(M.id,N);};e.Create$1=function(M,N){return new e.New(M,N);};e.New=w.Ctor(function(M,N){c.New.call(this);this.id=M;this.message=N;},e);f.Id=function(){(f.lastId())[0]++;return"Form"+a.String((f.lastId())[0]);};f.lastId=function(){v.$cctor();return v.lastId;};g.FailWith=function(M,N){return{$:1,$0:x.ofArray([new e.New(N==null?f.Id():N.$0,M)])};};g.Append=function(M,N,O){return N.$==0?O.$==0?{$:0,$0:M(N.$0,O.$0)}:O:O.$==0?N:{$:1,$0:x.append(N.$0,O.$0)};};g.Bind=function(M,N){return N.$==0?M(N.$0):{$:1,$0:N.$0};};g.ApJoin=function(M,N){var O;return M.$==0?(N.$==0?N.$0.$==0?(O=N.$0.$0,false):(O=N.$0.$0,true):(O=N.$0,true))?{$:1,$0:O}:{$:0,$0:M.$0(O)}:N.$==0?{$:1,$0:M.$0}:{$:1,$0:x.append(M.$0,N.$0)};};g.Apply=function(M,N){return M.$==0?N.$==0?{$:0,$0:M.$0(N.$0)}:{$:1,$0:N.$0}:N.$==0?{$:1,$0:M.$0}:{$:1,$0:x.append(M.$0,N.$0)};};g.Map=function(M,N){return N.$==1?{$:1,$0:N.$0}:{$:0,$0:M(N.$0)};};g.IsFailure=function(M){return M.$==1;};g.IsSuccess=function(M){return M.$!=1;};h.New=function(M,N,O){return{id:M,view:N,render:O};};i.memoize=function(M){var N;N=new z.New$5();return function(O){var P;return N.ContainsKey(O)?N.Item(O):(P=M(O),(N.set_Item(O,P),P));};};j=h.Dependent=w.Class({RenderDependent:function(M){return B.BindView(function(N){return N.$==1?B.get_Empty():N.$0.render(M);},this.pOut);}},c,j);j.New=w.Ctor(function(M,N){c.New.call(this);this.renderPrimary=M;this.pOut=N;this.out=C.Bind(function(O){return O.$==1?C.Const({$:1,$0:O.$0}):O.$0.view;},this.pOut);},j);j.Make=function(M,N){var O;return new j.New(M.render,C.Map((O=i.memoize(function(P){var Q;Q=N(P);return h.New(Q.id,Q.view,Q.render);}),function(P){return g.Map(O,P);}),M.view));};l=k.ItemOperations=w.Class({},c,l);l.New=w.Ctor(function(M,N,O){c.New.call(this);this["delete"]=M;this.moveUp=N;this.moveDown=O;},l);m.Int=function(){v.$cctor();return v.Int;};n=k.Collection=w.Class({adderView:function(M){M.$==0?this.add(M.$0):void 0;return B.get_Empty();},add:function(M){this.arr.push(this.mk(M));D.Update(this["var"],a.id);},fst3:a.id,mk:function(M){var N,O,P,Q,R,S,T,U,V;function W(X,Y,Z){return O===Z;}N=this;O=(m.Int())();P=function(X){return E.findIndex(function(Y){return W(Y[0],Y[1],Y[2]);},X);};Q=C.Map(P,this["var"].get_View());R=new F.New(C.Map(function(X){return X===0?{$:1,$0:x.T.Empty}:{$:0,$0:true};},Q),G.length(this.arr)===0?{$:1,$0:x.T.Empty}:{$:0,$0:false});S=C.Map(function(X){var Y;if(X.$==0)if(X.$0){Y=P(N.arr);k["List`1.Swap"](N.arr,Y,Y-1);D.Update(N["var"],a.id);}},R.view);T=new F.New(C.Map(function(X){return X===G.length(N.arr)-1?{$:1,$0:x.T.Empty}:{$:0,$0:true};},Q),{$:1,$0:x.T.Empty});U=C.Map(function(X){var Y;if(X.$==0)if(X.$0){Y=P(N.arr);k["List`1.Swap"](N.arr,Y,Y+1);D.Update(N["var"],a.id);}},T.view);V=this.p(M);return[h.New(V.id,C.Map2(a.id,V.view,C.Map2(function(){return null;},S,U)),V.render),new l.New(function(){var X,Y;X=N.arr;Y=P(N.arr);X.splice.apply(X,[Y,1]);D.Update(N["var"],a.id);},R,T),O];},RenderAdder:function(M){var N,O;N=this;O=this.adder.render(M);return B.Append(B.EmbedView(C.Map(function(P){return N.adderView(P);},this.adder.view)),O);},Render:function(M){function N(P,Q,R){return R;}function O(P,Q,R){return P.render(M(Q));}return B.ConvertBy(function(P){return N(P[0],P[1],P[2]);},function(P){return O(P[0],P[1],P[2]);},this.changesView);}},c,n);n.New=w.Ctor(function(M,N,O){var P,Q,R;function S(T){return P.mk(T);}P=this;c.New.call(this);this.p=M;this.adder=O;this.arr=w.MarkResizable([]);this["var"]=D.Create$1(this.arr);E.iter((Q=(R=this.arr,function(T){R.push(T);}),function(T){return Q(S(T));}),N);this.changesView=C.Bind(function(T){var U;U=T.slice();return H.MapTreeReduce(function(V){return C.Map(function(){return[V];},P.fst3(V[0],V[1],V[2]).view);},C.Const([]),function(V,W){return C.Map2(E.append,V,W);},U);},this["var"].get_View());this.out=C.Bind(function(T){var U,V,W;function X(Z,_0,_1){function _2(_3){return[_3];}return C.Map(function(_3){return g.Map(_2,_3);},Z.view);}function Y(Z,_0){return g.Append(E.append,Z,_0);}U=T.slice();V=C.Const({$:0,$0:[]});W=(w.Curried3(C.Map2))(Y);return H.MapTreeReduce(function(Z){return X(Z[0],Z[1],Z[2]);},V,function(Z,_0){return(W(Z))(_0);},U);},this["var"].get_View());},n);o=k.CollectionWithDefault=w.Class({AddOne:function(){this.add(this["default"]);}},n,o);o.New=w.Ctor(function(M,N,O,P){n.New.call(this,M,N,O);this["default"]=P;},o);k["List`1.Swap"]=function(M,N,O){var P;P=G.get(M,N);G.set(M,N,G.get(M,O));G.set(M,O,P);};p.Do={$:0};h.Dependent$1=function(M,N){var O;O=j.Make(M,N);return h.New(f.Id(),O.out,function(P){return P(O);});};h.Many$1=function(M,N,O){var P;P=new o.New(O,M,O(N),N);return h.New(f.Id(),P.out,function(Q){return Q(P);});};h.ManyForm=function(M,N,O){var P;P=new n.New(O,M,N);return h.New(f.Id(),P.out,function(Q){return Q(P);});};h.RunResult=function(M,N){return h.MapResult(function(O){M(O);return O;},N);};h.Run=function(M,N){return h.Map(function(O){M(O);return O;},N);};h.FlushErrors=function(M){return h.MapResult(function(N){return N.$==1?{$:1,$0:x.T.Empty}:N;},M);};h.MapRenderArgs=function(M,N){return h.New(N.id,N.view,function(O){return O(N.render(M));});};h.MapAsync=function(M,N){return h.MapAsyncResult(function(O){var P,Q,R,S;return O.$==1?(P=O.$0,(Q=null,I.Delay(function(){return I.Return({$:1,$0:P});}))):(R=O.$0,(S=null,I.Delay(function(){return I.Bind(M(R),function(T){return I.Return({$:0,$0:T});});})));},N);};h.MapToAsyncResult=function(M,N){return h.MapAsyncResult(function(O){var P,Q,R,S;return O.$==1?(P=O.$0,(Q=null,I.Delay(function(){return I.Return({$:1,$0:P});}))):(R=O.$0,(S=null,I.Delay(function(){return M(R);})));},N);};h.MapAsyncResult=function(M,N){return h.New(N.id,C.MapAsync(M,N.view),N.render);};h.Map=function(M,N){return h.MapResult(function(O){return g.Map(M,O);},N);};h.MapToResult=function(M,N){return h.MapResult(function(O){return g.Bind(M,O);},N);};h.MapResult=function(M,N){return h.New(N.id,C.Map(M,N.view),N.render);};h.TransmitViewMap=function(M,N){return h.TransmitViewMapResult(function(O){return g.Map(M,O);},N);};h.TransmitViewMapResult=function(M,N){return h.New(N.id,N.view,function(O){return(N.render(O))(C.Map(M,N.view));});};h.TransmitView=function(M){return h.New(M.id,M.view,function(N){return(M.render(N))(M.view);});};h.WithSubmit=function(M){var N;N=new F.New(M.view,{$:1,$0:x.T.Empty});return h.New(f.Id(),N.view,function(O){return(M.render(O))(N);});};h.ApJoin=function(M,N){var O,P;return h.New(f.Id(),C.Map2(g.ApJoin,M.view,N.view),(O=M.render,(P=N.render,function(Q){return P(O(Q));})));};h.Apply=function(M,N){var O,P;return h.New(f.Id(),C.Map2(g.Apply,M.view,N.view),(O=M.render,(P=N.render,function(Q){return P(O(Q));})));};h.YieldOption=function(M,N){var O;O=D.Create$1(M==null?N:M.$0);return h.New(O.get_Id(),C.Map(function(P){return{$:0,$0:J.Equals(P,N)?null:{$:1,$0:P}};},O.get_View()),function(P){return P(O);});};h.YieldFailure=function(){var M,N;M=D.Create$1(void 0);N=M.get_View();return h.New(M.get_Id(),C.SnapshotOn({$:1,$0:x.T.Empty},N,C.Map(function(O){return{$:0,$0:O};},N)),function(O){return O(M);});};h.Yield=function(M){return h.YieldVar(D.Create$1(M));};h.YieldVar=function(M){return h.New(M.get_Id(),C.Map(function(N){return{$:0,$0:N};},M.get_View()),function(N){return N(M);});};h.ReturnFailure=function(){return h.New(f.Id(),C.Const({$:1,$0:x.T.Empty}),a.id);};h.Return=function(M){return h.New(f.Id(),C.Const({$:0,$0:M}),a.id);};h.Render=function(M,N){var O;O=N.render(M);return B.Append(B.EmbedView(C.Map(function(){return B.get_Empty();},N.view)),O);};h.Create=function(M,N){return h.New(f.Id(),M,N);};q.MapValidCheckedInput=function(M,N){return h.MapResult(function(O){return O.$==1?{$:1,$0:O.$0}:O.$0.$==0?{$:0,$0:O.$0.$0}:{$:1,$0:x.ofArray([e.Create(N,M)])};},N);};q.IsMatch=function(M,N,O){var P;return q.Is((P=new a.RegExp(M),function(Q){return P.test(Q);}),N,O);};q.IsNotEmpty=function(M,N){return q.Is(function(O){return O!=="";},M,N);};q.Is=function(M,N,O){return h.MapResult(function(P){return P.$==1?P:M(P.$0)?P:{$:1,$0:x.ofArray([new e.New(O.id,N)])};},O);};r.op_LessMultiplyQmarkGreater=function(M,N){return h.ApJoin(M,N);};r.op_LessMultiplyGreater=function(M,N){return h.Apply(M,N);};s.SubmitterValidate=function(M){var N;return K.Append(L.Handler("click",function(){return function(){return M.Trigger();};}),(N=C.Const("disabled"),L.DynamicPred("disabled",C.Map(g.IsFailure,M.input),N)));};t.ShowSuccess=function(M,N){return B.BindView(function(O){return O.$==1?B.get_Empty():N(O.$0);},M);};t.ShowErrors=function(M,N){return B.BindView(function(O){return O.$==1?N(O.$0):B.get_Empty();},M);};t.ButtonValidate=function(M,N,O){return B.Element("button",E.append([s.SubmitterValidate(O)],N),[B.TextNode(M)]);};u.Through=function(M,N){return C.Map(function(O){return O.$==1?{$:1,$0:x.filter(function(P){return P.id===N.id;},O.$0)}:O;},M);};u.Through$1=function(M,N){return C.Map(function(O){return O.$==1?{$:1,$0:x.filter(function(P){return P.id===N.get_Id();},O.$0)}:O;},M);};v.$cctor=function(){var M;v.$cctor=a.ignore;v.lastId=[0];v.Int=(M=[0],function(){M[0]++;return M[0];});};}(self));
